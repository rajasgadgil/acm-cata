!function(a,e,o,t){function n(a){return a.replace(/\\(.)/gm,"$1")}a.imp_editor_storage_get_saves_list=function(e){var o={action:"image_map_pro_get_saves_list"};a.post(ajaxurl,o).done(function(a){a=n(a),a=n(a);var o=JSON.parse(a);e(o)})},a.imp_editor_storage_get_save=function(e,o){var t={action:"image_map_pro_get_number_of_fragments_for_save",saveID:e};a.post(ajaxurl,t).done(function(t){function r(){var a="";for(var e in _)a+=_[e];var t={};a=n(a);try{t=JSON.parse(a)}catch(e){console.log("Failed to parse JSON: "),console.log("------"),console.log(a),t=!1}o(t)}0==t&&o(!1),t=parseInt(t,10);for(var _={},s=0,i=0;i<t;i++){var g={action:"image_map_pro_get_save_fragment",saveID:e,index:i};a.post(ajaxurl,g).done(function(a){var e=JSON.parse(a);_[e.index]=e.fragment,s++,s==t&&r()})}})},a.imp_editor_storage_store_save=function(e,o){var t={action:"image_map_pro_store_save_meta",saveID:e.id,meta:{name:e.general.name,id:e.id,shortcode:e.general.shortcode}};a.post(ajaxurl,t).done(function(t){var n={action:"image_map_pro_get_max_fragment_size"};a.post(ajaxurl,n).done(function(t){function n(e,t,n){setTimeout(function(){console.log(t),console.log("\n-----------\n"),console.log(n),console.log("\n-----------\n");var _={action:"image_map_pro_store_save_fragment",saveID:e,index:t,fragment:n};a.post(ajaxurl,_).done(function(a){m++;var e=Math.round(m/p*100);o(e),m==p&&r()})},200*t)}function r(){var t={action:"image_map_pro_store_save_complete",saveID:e.id,fragmentsLength:p};a.post(ajaxurl,t).done(function(a){o()})}for(var _=parseInt(t,10),s=JSON.stringify(e),i=[],g=s.length,c=0;c<g;c+=_)i.push(s.substring(c,c+_));for(var c=0,p=i.length,m=0,c=0;c<p;c++)n(e.id,c,i[c])})})},a.imp_editor_storage_delete_save=function(e,o){var t={action:"image_map_pro_delete_save",saveID:e};a.post(ajaxurl,t).done(function(a){o()})},a.imp_editor_storage_get_last_save=function(e){var o={action:"image_map_pro_get_last_save"};a.post(ajaxurl,o).done(function(a){e(a.length>0?a:!1)})},a.imp_editor_storage_set_last_save=function(e,o){var t={action:"image_map_pro_set_last_save",saveID:e};a.post(ajaxurl,t).done(function(){o()})}}(jQuery,window,document);